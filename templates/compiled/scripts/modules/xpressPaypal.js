define(["modules/jquery-mozu","modules/api","modules/models-cart","hyprlivecontext","underscore"],function(e,t,a,n,o){window.paypalCheckoutReady=function(){var t=n.locals.siteContext,c=o.findWhere(t.checkoutSettings.externalPaymentWorkflowSettings,{name:"PayPalExpress2"}),i=o.findWhere(c.credentials,{apiName:"merchantAccountId"}),l=o.findWhere(c.credentials,{apiName:"environment"}),r=a.Cart.fromCurrent().id,u=window.location.href.indexOf("cart")>0;paypal.checkout.setup(i.value,{environment:l.value,click:function(t){t.preventDefault(),paypal.checkout.initXO(),e.ajax({url:"../paypal/token?id="+r+"&isCart="+u+(document.URL.split("?")[1]?"&"+document.URL.split("?")[1].replace("id="+r,"").replace("&&","&"):""),type:"GET",async:!0,success:function(e){var t=paypal.checkout.urlPrefix+e.token;paypal.checkout.startFlow(t)},error:function(e){console.log("Error in ajax post "+e.statusText),paypal.checkout.closeFlow()}})},button:["btn_xpressPaypal"]})},e.getScript("//www.paypalobjects.com/api/checkout.js").done(function(){}).fail(function(e){console.log(e)})});